<!DOCTYPE html>
<html lang="es">

<head>
    <base href="/">
    <title>Perfil - We Are Spicy</title>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="resources/img/icons/spicy-red.svg">
    <link rel="stylesheet" href="resources/css/bootstrap.min.css">
    <link href="./resources/css/styles_v2.css" rel="stylesheet" type="text/css">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://kit.fontawesome.com/46eaecfcc0.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>

<body class="open bg-pink">
    <aside class="aside">
        <div class="logo-container">
            <a href="/"><i class="icon icon-spicy"></i></a>
        </div>
        <ul class="aside-list col-12">
            <li><a href="/analytics" title="Analytics"><i class="icon icon-chart"></i><span class="list-item">Analytics</span></a></li>
            <li><a href="/consultoria" title="Consultoria"><i class="icon icon-message"></i><span>Consultoria</span></a>
            </li>
            <li><a href="/extras" title="Extras"><i class="icon icon-light"></i><span>Extras</span></a></li>
            <li><a href="/pedidos" title="Pedidos"><i class="icon icon-file"></i><span>Pedidos</span></a></li>
            <li><a href="/social-media" title="Social media"><i class="icon icon-calendar"></i><span>Social media</span></a></li>
            <li><a href="/contacto" title="Contacto"><i class="icon icon-help"></i><span>Contacto</span></a></li>
        </ul>
        <div style="position: absolute; bottom: 10%; width: 100%; text-align: center;">
            <div id="menuToggle"><i class="icon icon-chevron"></i></div>
        </div>
    </aside>
    <section id="right-panel" class="right-panel">
        <header class="header navbar">
            <!--Crear dropdown-->
            <div class="dropdown-accounts">
                <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Cuenta
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a href="" class="dropdown-item">Cuenta</a>
                    <a href="" class="dropdown-item">Cuenta</a>
                    <a href="" class="dropdown-item">Cuenta</a>
                </div>
            </div>
            <div class="header-icons ml-5">
                <a href="/mensajes" title="Mensajes"><i class="icon icon-sm icon-message-red"></i></a>
                <div class="dropdown">
                    <button type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                        <a href="#" title="Perfil"><i class="profile icon icon-sm icon-user-red"></i></a>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" href="#">Mi cuenta</a></li>
                        <li><a class="dropdown-item" href="#">Mis redes sociales</a></li>
                        <li><a class="dropdown-item" href="#">Cuentas</a></li>
                    </ul>
                </div>
                <a href="/salir" title="Salir"><i class="icon icon-sm icon-out"></i></a>
            </div>
        </header>

        <!-- bottom-menu -->
        <div class="responsive-bottom-menu py-3">
            <a href="/" class="mb-3" title="Inicio"><i class="icon icon-spicy"></i></a>
            <a href="/analytics" title="Analytics"><i class="icon icon-chart"></i></a>
            <a href="/social-media" title="Social Media"><i class="icon icon-calendar"></i></a>
            <a href="/pedidos" title="Pedidos"><i class="icon icon-file"></i></a>
            <a href="/contacto" title="Contacto"><i class="icon icon-help"></i></a>
        </div>

        <div id="content">
            <div class="pb-3 top-account">
                <h1 class="text-red title-index text-center">Nombre de usuario</h1>
                <hr>
                <div class="p-0 m-0 option-box">
                    <a href="/perfil/datos" class="profile-option bg-red active" data-target="#form-data">Mi cuenta</a>
                    <a href="/perfil/redes" class="profile-option bg-red" data-target="#form-redes">Redes sociales</a>
                    <a href="/perfil/baja" class="profile-option bg-red" data-target="#form-baja">Cuentas</a>
                </div>
            </div>

            <div class="w-75 pt-3 pb-md-0 pb-5 div-datos">
                <form id="form-data" action="/perfil/datos" method="post" class="form bg-red">
                    <h4 class="font-weight-bold">Datos:</h4>
                    <div class="form-group">
                        <label for="empresa" class="mb-1 font-weight-bold">Empresa:</label>
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-user-red"></i></div>
                            <input id="datos_empresa" name="empresa" type="text" class="ctm-form-control" minlength="5" maxlength="50" value="" placeholder="We Are Spicy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="web" class="mb-1 font-weight-bold">Sitio web:</label>
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-website"></i></div>
                            <input id="datos_web" name="web" type="url" class="ctm-form-control" maxlength="80" value="" placeholder="https://app.wearespicy.net/">
                        </div>
                    </div>
                    <div class="form-group form-data-submit pb-3 position-relative">
                        <div id="datos-message" class="text-success"></div>
                        <div>
                            <input id="datos_btn_submit" type="submit" value="Cambiar contraseña" class="btn-submit font-weight-bold">
                        </div>
                    </div>
                    <h4 class="font-weight-bold">Contacto:</h4>
                    <div class="form-group">
                        <label for="mail" class="mb-1 font-weight-bold">Correo electrónico:</label>
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-user-red"></i></div>
                            <input id="contact-mail" name="mail" type="text" class="ctm-form-control" minlength="5" maxlength="50" value="" placeholder="wearespicy@gmail.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="phone" class="mb-1 font-weight-bold">Teléfono:</label>
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-phone"></i></div>
                            <input id="phone" name="phone" type="url" class="ctm-form-control" maxlength="80" value="" placeholder="+54 011 1234 5678">
                        </div>
                    </div>
                    <div class="form-group form-contact-submit pb-3 position-relative font-weight-bold text-body">
                        <div id="datos-message" class="text-success"></div>
                        <div>
                            <input id="datos_btn_submit" type="submit" value="Eliminar cuenta" class="btn-submit font-weight-bold">
                        </div>
                    </div>
                </form>
                
                <!--NO VISIBLE-->
                <form id="form-clave" action="/perfil/clave" method="post" class="form mt-5 bg-white">
                    <h4 class="font-weight-bold text-red">Cambiar contraseña</h4>
                    <div class="form-group">
                        <div class="d-flex inputs w-50 mt-3">
                            <div class="icon-container p-2"><i class="icon icon-lock"></i></div>
                            <input id="clave_actual" name="clave_actual" type="password" class="ctm-form-control" minlength="8" maxlength="32" required="" placeholder="Tu contraseña actual">
                        </div>
                        <p id="clave_error_actual" class="msg-error pt-1 text-danger"></p>
                    </div>
                    <div class="form-group">
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-lock"></i></div>
                            <input id="clave_nueva" name="clave_nueva" type="password" class="ctm-form-control" minlength="8" maxlength="32" required="" placeholder="Contraseña nueva">
                        </div>
                        <p id="clave_error_nueva" class="msg-error pt-1 text-danger"></p>
                    </div>
                    <div class="form-group">
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-lock"></i></div>
                            <input id="clave_repetir" name="clave_repetir" type="password" class="ctm-form-control" minlength="8" maxlength="32" required="" placeholder="Confirmar contraseña nueva">
                        </div>
                        <p id="clave_error_rep" class="msg-error pt-1 text-danger"></p>
                    </div>
                    <div class="form-group row m-0">
                        <div id="clave-message" class="col-md-6 col-12 pt-lg-1 pb-lg-0 pb-3 px-0 text-success"></div>
                        <div class="col-md-6 col-12 px-0 text-right">
                            <input id="clave_btn_submit" type="submit" value="Guardar cambios" class="btn btn-red">
                        </div>
                    </div>
                </form>

                <section class="mt-5">
                    <div class="btn-div mb-3">
                        <button class="conect-new">+ Conectar cuenta</button>
                    </div>
                    <form id="form-redes" action="/perfil/redes" method="post" class="form">
                        <div class="col-12 p-0">
                            <table class="table mb-5">
                                <thead class="bg-red text-center">
                                    <tr>
                                        <th scope="col">Red social</th>
                                        <th scope="col">Cuenta</th>
                                        <th scope="col">Estado</th>
                                        <th scope="col">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody class="text-center text-body">
                                    <tr class="table-light">
                                        <td class="d-flex justify-content-center"><img src="resources/img/icons/facebook-bluee.svg" width="20" class="mr-1"> Facebook</td>
                                        <td class="align-middle">No conectado</td>
                                        <td class="align-middle">-</td>
                                        <td class="align-middle"><a href="https://www.facebook.com/v11.0/dialog/oauth?client_id=217017559787361&amp;state=4ccef14f8782a67d87134075df57a49f&amp;response_type=code&amp;sdk=php-sdk-5.7.0&amp;redirect_uri=https%3A%2F%2Fapp.wearespicy.net%2Ffb-login-callback&amp;scope=public_profile%2Cemail%2Cpages_show_list%2Cpages_read_engagement%2Cpages_manage_posts%2Cinstagram_basic%2Cinstagram_content_publish%2Cinstagram_manage_insights%2Cread_insights%2Cads_management" class="btn btn-info rounded-pill px-lg-3 py-0">Conectar</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </form>
                </section>

                <!--<form id="form-canales" action="/perfil/canales" method="post" class="form">
                    <div class="col-12 p-0">
                        <table class="table">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col" style="white-space: nowrap;">Cuenta</th>
                                    <th scope="col">Acciones</th>
                                    <th scope="col"></th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-4 p-0">
                        <button type="button" data-toggle="modal" class="btn btn-danger btn-block px-lg-4 py-0"
                            data-target="#crear_cuenta">Nueva Cuenta</button>
                    </div>
                </form>-->
                
                <!--NO VISIBLE-->
                <form id="form-baja" action="/perfil/baja" method="post" class="form mt-5 bg-white">
                    <div class="form-group">
                        <h4 class="font-weight-bold text-red">Eliminar cuenta</h4>
                        <p class="text-dark"><b>ADVERTENCIA:</b> Esta acción no podrá deshacerse y no podrás volver a acceder a tu cuenta.</p>
                    </div>
                    <div class="form-group">
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-lock"></i></div>
                            <input id="baja_clave" name="baja_clave" type="password" class="ctm-form-control" required="" placeholder="Contraseña">
                        </div>
                        <p id="baja_error_clave" class="msg-error pt-1 text-danger"></p>
                        <div class="d-flex inputs w-50">
                            <div class="icon-container p-2"><i class="icon icon-lock"></i></div>
                            <input id="baja_clave" name="baja_clave" type="password" class="ctm-form-control" required="" placeholder="Repetir contraseña">
                        </div>
                    </div>
                    <div class="form-group row m-0">
                        <div id="baja-message" class="col-md-6 col-12 pt-lg-1 pb-lg-0 pb-3 px-0 text-success"></div>
                        <div class="col-md-6 col-12 px-0 text-right">
                            <input id="baja_btn_submit" type="submit" value="Eliminar cuenta" class="btn btn-red">
                        </div>
                    </div>
                </form>

                <!--NO VISIBLE-->
                <form id="form-clients" action="/perfil/clientes" method="post" class="form mt-5 bg-white">
                    <div class="form-group d-flex">
                        <h4 class="font-weight-bold text-red pl-3 pt-3">Clientes</h4>
                        <img src="resources/img/icons/plus.svg" alt="" class="mt-3">
                    </div>
                    <div class="clients d-flex" style="flex-wrap: wrap;">
                        <div class="ml-5">
                            <img src="resources/img/publicaciones/LogoFB.png"alt="">
                            <p class="text-center text-body font-weight-bold">We Are Spicy</p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        </div>

        <div class="modal fade" id="editar_cuenta" tabindex="-1" role="dialog" aria-labelledby="editar_cuentaLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header rounded-0 text-white py-2 bg-red">
                        <h5 class="modal-title" id="editar_cuentaLabel"></h5>
                        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <table class="table">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col" style="white-space: nowrap;">Red social</th>
                                    <th scope="col">Cuenta</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary">Guardar</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="borrar_cuenta" tabindex="-1" role="dialog" aria-labelledby="borrar_cuentaLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header rounded-0 text-white py-2 bg-red">
                        <h5 class="modal-title" id="borrar_cuentaLabel"></h5>
                        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger">ELIMINAR</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="compartir_cuenta" tabindex="-1" role="dialog"
            aria-labelledby="compartir_cuentaLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header rounded-0 text-white py-2 bg-red">
                        <h5 class="modal-title" id="compartir_cuentaLabel"></h5>
                        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>Ingresá el email del usuario a quien quieres compartir la cuenta:</p>
                        <div class="form-group">
                            <input class="form-control" type="email" name="compartir_email" id="compartir_email">
                            <small id="emailHelp" class="form-text text-muted">Podés compartirle a varios usuarios separando sus emails con comas y sin espacios.</small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="compartir" class="btn btn-danger">COMPARTIR</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="crear_cuenta" tabindex="-1" role="dialog" aria-labelledby="crear_cuentaLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header rounded-0 text-white py-2 bg-red">
                        <h5 class="modal-title" id="crear_cuentaLabel">Nueva Cuenta</h5>
                        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <input type="text" id="nombre_cuenta" class="form-control" placeholder="Nombre de la Cuenta">
                        </div>
                        <div class="form-group">
                            <select name="espacio_1" id="espacio_1" class="form-control">
                                <option value="">Selecciona un Canal</option>
                                <optgroup label="Facebook">
                                </optgroup>
                                <optgroup label="Instagram">
                                </optgroup>
                                <optgroup label="Facebook Ads">
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="espacio_2" id="espacio_2" class="form-control" style="display: none">
                                <option value="">Selecciona un Canal</option>
                                <optgroup label="Facebook">
                                </optgroup>
                                <optgroup label="Instagram">
                                </optgroup>
                                <optgroup label="Facebook Ads">
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="espacio_3" id="espacio_3" class="form-control" style="display: none">
                                <option value="">Selecciona un Canal</option>
                                <optgroup label="Facebook">
                                </optgroup>
                                <optgroup label="Instagram">
                                </optgroup>
                                <optgroup label="Facebook Ads">
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="espacio_4" id="espacio_4" class="form-control" style="display: none">
                                <option value="">Selecciona un Canal</option>
                                <optgroup label="Proximamente">
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="espacio_5" id="espacio_5" class="form-control" style="display: none">
                                <option value="">Selecciona un Canal</option>
                                <optgroup label="Proximamente">
                                </optgroup>
                            </select>
                        </div>
                        <table>
                            <tbody>
                                <tr></tr>
                                <tr></tr>
                                <tr></tr>
                                <tr></tr>
                                <tr></tr>
                            </tbody>
                        </table>
                        <span id="mensaje" class="d-none"></span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="nueva_cuenta">Crear</button>
                    </div>
                </div>
            </div>

        </div>


        <script src="resources/js/jquery.min.js"></script>
        <script src="resources/js/popper.min.js"></script>
        <script src="resources/js/bootstrap.min.js"></script>
        <script src="resources/js/custom.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
        <script type="text/javascript">
            $(document).ready(function () {

                /* menu de opciones */

                $(document).on('click', '.profile-option', function (e) {
                    e.preventDefault();
                    window.history.pushState('perfil', 'Title', $(this).attr("href"));
                    if (!$(this).hasClass("active")) {
                        $(".profile-option").each(function () {
                            $(this).removeClass("active");
                        });
                        $(this).addClass("active");
                        $(".form").each(function () {
                            $(this).addClass("d-none");
                        });
                        var target = $(this).attr("data-target");
                        $(target).removeClass("d-none");
                    }
                });

                /* submit perfil*/
                $(document).on('submit', '#form-data', function (e) {
                    e.preventDefault();
                    clearFields();
                    $("#datos_btn_submit").val("Cargando...");
                    var formData = $("#form-data").serialize();

                    $.ajax({
                        type: "POST",
                        url: "/perfil/datos",
                        data: formData,
                        success: function (data) {
                            $("#datos_btn_submit").val("Guardar cambios");
                            if (data == "400") {
                                $("#datos-message").removeClass("text-success");
                                $("#datos-message").addClass("text-danger");
                                $("#datos-message").html("Ocurrió un error.");
                                setTimeout(function () {
                                    $("#datos-message").html("");
                                }, 2000);
                            } else if (data == "401") {
                                $("#datos_error_email").html(
                                    "Este correo electrónico ya está asociado a una cuenta."
                                    );
                                $("#datos_email").focus();
                            } else if (data == "200") {
                                $("#datos-message").removeClass("text-danger");
                                $("#datos-message").addClass("text-success");
                                $("#datos-message").html(
                                    "Los cambios fueron guardados correctamente.");
                                setTimeout(function () {
                                    $("#datos-message").html("");
                                }, 2000);
                            }
                        }
                    });
                });

                /* submit clave */
                $(document).on('submit', '#form-clave', function (e) {
                    e.preventDefault();
                    clearFields();
                    $("#clave_btn_submit").val("Cargando...");
                    var formData = $("#form-clave").serialize();
                    $.ajax({
                        type: "POST",
                        url: "/perfil/clave",
                        data: formData,
                        success: function (data) {
                            $("#clave_btn_submit").val("Guardar cambios");
                            if (data == "400") {
                                $("#clave-message").removeClass("text-success");
                                $("#clave-message").addClass("text-danger");
                                $("#clave-message").html("Ocurrió un error.");
                                setTimeout(function () {
                                    $("#clave-message").html("");
                                }, 2000);
                            } else if (data == "401") {
                                $("#clave_error_actual").html(
                                    "La contraseña es incorrecta.");
                                $("#clave_actual").focus();
                            } else if (data == "402") {
                                $("#clave_error_nueva").html(
                                    "La contraseña nueva debe ser distinta a la actual."
                                    );
                                $("#clave_nueva").focus();
                            } else if (data == "403") {
                                $("#clave_error_rep").html("Las contraseñas no coinciden.");
                                $("#clave_repetir").focus();
                            } else if (data == "200") {
                                $("#clave-message").removeClass("text-danger");
                                $("#clave-message").addClass("text-success");
                                $("#clave-message").html(
                                    "Los cambios fueron guardados correctamente.");
                                setTimeout(function () {
                                    $("#clave-message").html("");
                                }, 2000);
                            }
                        }
                    });
                });

                /* submit baja */
                $(document).on('submit', '#form-baja', function (e) {
                    e.preventDefault();
                    clearFields();
                    $("#datos_btn_submit").val("Cargando...");
                    var formData = $("#form-baja").serialize();
                    $.ajax({
                        type: "POST",
                        url: "/perfil/baja",
                        data: formData,
                        success: function (data) {
                            $("#datos_btn_submit").val("Guardar cambios");
                            if (data == "400") {
                                $("#baja-message").removeClass("text-success");
                                $("#baja-message").addClass("text-danger");
                                $("#baja-message").html("Ocurrió un error.");
                                setTimeout(function () {
                                    $("#datos-message").html("");
                                }, 2000);
                            } else if (data == "401") {
                                $("#baja_error_clave").html("La contraseña es incorrecta.");
                                $("#baja_clave").focus();
                            } else if (data == "200") {
                                $("#baja-message").removeClass("text-danger");
                                $("#baja-message").addClass("text-success");
                                $("#baja-message").html("Tu cuenta fue dada de baja.");
                                setTimeout(function () {
                                    location.reload();
                                }, 1500);
                            }
                        }
                    });
                });

                /* submit conectar canal */
                $(document).on('click', '.btn-connect', function () {
                    var id = $(this).attr("data-id");
                    var estado = $(this).attr("data-type");
                    var formData = "id=" + id + "&estado=" + estado;
                    id = $(this).attr("id");

                    $.ajax({
                        type: "POST",
                        url: "/perfil/canales",
                        data: formData,
                        success: function (data) {
                            if (data == "200") {
                                location.reload();
                                if (estado == 0) {
                                    $(this).text("Conectar");
                                    $(this).removeClass("btn-danger");
                                    $(this).addClass("btn-primary");
                                    $(this).attr("data-type", 0);
                                } else {
                                    $(this).text("Desconectar");
                                    $(this).removeClass("btn-primary");
                                    $(this).addClass("btn-danger");
                                    $(this).attr("data-type", 1);
                                }
                            } else {
                                alert("Ocurrió un error");
                            }
                        }
                    });
                });

                $(document).on('click', '.btn-delete', function () {
                    let id = $(this).attr('data-delete');
                    let cuenta = $(this).attr('data-cuenta');
                    let formData = 'delete_canales=' + id + '&id_cuenta=' + cuenta;
                    console.log(id)
                    console.log(cuenta)
                    $.ajax({
                        type: "POST",
                        url: "perfil/canales",
                        data: formData,
                        success: function (data) {
                            console.log(data)
                            if (data == '200') {
                                location.reload();
                            } else {
                                alert("Ocurrió un error");
                            }
                        }
                    });
                });


                $('#editar_cuenta').on('show.bs.modal', function (event) {
                    let modal = $(this);
                    let button = $(event.relatedTarget);
                    let contenido = button.data('editar');
                    let nombre = button.data('nombre');
                    // console.log(contenido)
                    let formData = 'editar_canales=' + contenido;
                    // console.log(formData)
                    modal.find('tbody').html('');

                    $.ajax({
                        type: "POST",
                        url: "/perfil/canales",
                        data: formData,
                        dataType: "json",
                        success: function (data, textStatus) {
                            console.log(data)
                            // console.log(textStatus)
                            if (textStatus == "success") {
                                // console.log('Éxito');
                                $.each(data, function (index, value) {
                                    let rrss = (value.tipo == 1) ?
                                        `<img src="resources/img/icons/instagram-square.svg" class="mr-1" width="20"> Instagram</td>` :
                                        `<img src="resources/img/icons/facebook-bluee.svg" width="20" class="mr-1"> Facebook</td>`;
                                    modal.find('tbody').html(modal.find('tbody')
                                        .html() + `
									<tr class="table-light">
										<td class="d-flex align-middle"> ${rrss}
										<td class="align-middle" id="cuenta_nombre"> ${value.nombre} </td>
										<td class="align-middle"><button type='button' data-delete=${value.canal_id} data-cuenta=${contenido} class='btn-delete btn btn-danger btn-block px-lg-4 py-0'><i class="fas fa-times"></i></button></td>
									</tr>
									`);
                                });
                            } else {
                                alert("Ocurrió un error");
                            }
                        }
                    });
                    modal.find('.modal-title').text('Editar cuenta ' + nombre);
                });

                $('#borrar_cuenta').on('click', '.btn-danger', function () {
                    // console.log('Borrando Cuenta')
                    let cuenta = $(this).data('borrar');
                    // console.log(cuenta)
                    let formData = 'borrar_cuenta=' + cuenta;
                    // console.log(formData)

                    $.ajax({
                        type: "POST",
                        url: "/perfil/canales",
                        data: formData,
                        success: function (data) {
                            console.log(data)
                            if (data == '200') {
                                Swal.fire({
                                    title: 'Cuenta Eliminada con Éxito',
                                    text: '',
                                    icon: 'success',
                                    timer: 2000,
                                    showConfirmButton: false,
                                    willClose: () => {
                                        location.reload()
                                    }
                                })
                            } else if (data == '400') {
                                Swal.fire('Ocurrió un Error', '', 'error')
                            }
                        }
                    });
                });

                $('#borrar_cuenta').on('show.bs.modal', function (event) {
                    let modal = $(this);
                    let button = $(event.relatedTarget);
                    let nombre = button.data('nombre');
                    let id = button.data('cuenta');

                    modal.find('.modal-title').text('Borrar cuenta ' + nombre);
                    modal.find('.modal-body').text('¿Estás seguro de borrar la cuenta ' + nombre + '?');
                    modal.find('.btn-danger').attr('data-borrar', id);
                });

                $('#compartir_cuenta').on('show.bs.modal', function (event) {
                    let modal = $(this);
                    let button = $(event.relatedTarget);
                    let nombre = button.data('nombre');
                    let id = button.data('cuenta');

                    modal.find('.modal-title').text('Compartir cuenta ' + nombre);
                    modal.find('.btn-danger').attr('data-compartir', id);
                });

                $('#compartir').on('click', function () {
                    console.log('Compartiendo Cuenta')
                    let cuenta = $(this).data('compartir');
                    let mail = $('#compartir_email').val()

                    console.log(cuenta)
                    let formData = 'compartir_cuenta=' + cuenta + '&compartir_email=' + mail
                    console.log(formData)

                    $.ajax({
                        type: "POST",
                        url: "/perfil/canales",
                        data: formData,
                        success: function (data) {
                            console.log(data)
                            if (data == '200') {
                                Swal.fire({
                                    title: 'Cuenta Compartida con Éxito',
                                    text: '',
                                    icon: 'success',
                                    timer: 2000,
                                    showConfirmButton: false,
                                    willClose: () => {
                                        location.reload()
                                    }
                                })
                            } else if (data == '400') {
                                Swal.fire('Ocurrió un Error', '', 'error')
                            }
                        }
                    });
                });




                //Crear nueva Cuenta
                $('#espacio_1').on('change', function () {
                    $('#espacio_2').removeAttr('style');

                    $('#espacio_2').on('change', function () {
                        $('#espacio_3').removeAttr('style');

                        $('#espacio_3').on('change', function () {
                            $('#espacio_4').removeAttr('style');

                            $('#espacio_4').on('change', function () {
                                $('#espacio_5').removeAttr('style');

                                if ($('#espacio_4').val() == '') {
                                    $('#espacio_5').attr('style',
                                        'display: none');
                                    $('#espacio_5').val('');
                                }
                            });

                            if ($('#espacio_3').val() == '') {
                                $('#espacio_4').attr('style', 'display: none');
                                $('#espacio_4').val('');
                                $('#espacio_5').attr('style', 'display: none');
                                $('#espacio_5').val('');
                            }
                        });

                        if ($('#espacio_2').val() == '') {
                            $('#espacio_3').attr('style', 'display: none');
                            $('#espacio_3').val('');
                            $('#espacio_4').attr('style', 'display: none');
                            $('#espacio_4').val('');
                            $('#espacio_5').attr('style', 'display: none');
                            $('#espacio_5').val('');
                        }
                    });

                    if ($('#espacio_1').val() == '') {
                        $('#espacio_2').attr('style', 'display: none');
                        $('#espacio_2').val('');
                        $('#espacio_3').attr('style', 'display: none');
                        $('#espacio_3').val('');
                        $('#espacio_4').attr('style', 'display: none');
                        $('#espacio_4').val('');
                        $('#espacio_5').attr('style', 'display: none');
                        $('#espacio_5').val('');
                    }
                });

                $('#nueva_cuenta').on('click', function () {
                    let esp_1 = $('#espacio_1').val()
                    let esp_2 = $('#espacio_2').val()
                    let esp_3 = $('#espacio_3').val()
                    let esp_4 = $('#espacio_4').val()
                    let esp_5 = $('#espacio_5').val()
                    let nombre = $('#nombre_cuenta').val()

                    let arreglo = [esp_1];
                    if (esp_2 !== '') {
                        arreglo.push(esp_2)
                    }
                    if (esp_3 !== '') {
                        arreglo.push(esp_3)
                    }
                    if (esp_4 !== '') {
                        arreglo.push(esp_4)
                    }
                    if (esp_5 !== '') {
                        arreglo.push(esp_5)
                    }
                    // console.log(arreglo);

                    arreglo.sort();
                    // console.log(arreglo);

                    let duplicados = []
                    for (let i = 0; i < arreglo.length; i++) {
                        if (arreglo[i + 1] === arreglo[i] && duplicados[i] !== '') {
                            duplicados.push(arreglo[i]);

                        }
                    }


                    if (duplicados.length >= 1) {
                        console.log('Hay cuentas repetidas');
                        $('#mensaje').removeAttr('style');
                        $('#mensaje').addClass('alert alert-danger');
                        $('#mensaje').html('Existen canales duplicados')
                    } else {
                        $('#mensaje').attr('style', 'display: none');
                        $('#mensaje').removeClass('alert alert-danger');
                        $('#mensaje').html('');
                    }


                    if (duplicados.length == 0) {
                        for (let i = arreglo.length; i < 6; i++) {
                            arreglo.push(0);

                        }
                        string = arreglo.toString();
                        console.log(string)
                        let formData = "cuenta=" + string + "&nombre_cuenta=" + nombre;

                        $.ajax({
                            type: "POST",
                            url: "/perfil/canales",
                            data: formData,
                            success: function (data, textStatus, jqXHR) {
                                console.log(data)
                                console.log(textStatus)
                                console.log(jqXHR)
                                if (data == "200") {
                                    location.reload();
                                } else if (data == "400") {
                                    Swal.fire('Ocurrió un Error',
                                        'No se pude crear la Cuenta', 'error')
                                } else if (data == "401") {
                                    Swal.fire('Ocurrió un Error',
                                        'Hay un error al enviar el formulario', 'error')
                                }
                            }
                        });
                    }



                });
            });

            function clearFields() {
                $(".msg-error").each(function () {
                    $(this).html("");
                });
            }
        </script>


</body>

</html>